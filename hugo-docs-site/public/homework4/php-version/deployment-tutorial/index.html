<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
    <link rel="stylesheet" href="/css/custom.css">
</head>
<body>
    <header>
        <h1>NKU 640 Documentation</h1>
        <nav>
            <ul>
                
                    <li><a href="/">Home</a></li>
                
                    <li><a href="/homework3/">Homework 3</a></li>
                
                    <li><a href="/homework4/">Homework 4</a></li>
                
                    <li><a href="/homework5/">Homework 5</a></li>
                
            </ul>
        </nav>
    </header>
    <main>
        <h1></h1>
<h1 id="nginx-deployment-tutorial">NGINX Deployment Tutorial</h1>
<p><strong>Deploying PHP REST API with NGINX</strong></p>
<p>A Step-by-Step Guide with Screenshots</p>
<hr>
<h2 id="table-of-contents">Table of Contents</h2>
<ol>
<li><strong>Prerequisites &amp; Setup</strong></li>
<li><strong>Server Installation</strong></li>
<li><strong>Application Deployment</strong></li>
<li><strong>NGINX Configuration</strong></li>
<li><strong>Testing &amp; Verification</strong></li>
<li><strong>Troubleshooting</strong></li>
</ol>
<hr>
<h1 id="1-prerequisites--setup">1. Prerequisites &amp; Setup</h1>
<p>What You Need to Get Started</p>
<hr>
<h2 id="system-requirements">System Requirements</h2>
<p><strong>Server Environment:</strong></p>
<ul>
<li>Ubuntu 20.04 / 22.04 LTS (or similar Linux distribution)</li>
<li>Minimum 1GB RAM</li>
<li>10GB disk space</li>
<li>Root or sudo access</li>
</ul>
<p><strong>Required Software:</strong></p>
<ul>
<li>NGINX web server</li>
<li>PHP 8.1 or higher</li>
<li>PHP-FPM (FastCGI Process Manager)</li>
<li>SQLite3</li>
<li>Composer (PHP package manager)</li>
</ul>
<p><strong>Network Requirements:</strong></p>
<ul>
<li>Open port 80 (HTTP)</li>
<li>Optional: Port 443 (HTTPS with SSL)</li>
</ul>
<hr>
<h2 id="deployment-overview">Deployment Overview</h2>
<pre tabindex="0"><code>┌─────────────────────────────────────────────┐
│         Internet / Client Requests          │
└─────────────────┬───────────────────────────┘
                  │
                  ▼
         ┌────────────────┐
         │  NGINX Server  │  (Port 80/443)
         │  Web Server    │
         └────────┬───────┘
                  │
                  ▼
         ┌────────────────┐
         │   PHP-FPM      │  (FastCGI)
         │   PHP Runtime  │
         └────────┬───────┘
                  │
                  ▼
    ┌─────────────────────────────┐
    │   PHP TODO REST API         │
    │   /var/www/php-todo-api     │
    └─────────────┬───────────────┘
                  │
                  ▼
         ┌────────────────┐
         │  SQLite DB     │
         │  todo.db       │
         └────────────────┘
</code></pre><hr>
<h1 id="2-server-installation">2. Server Installation</h1>
<p>Installing Required Software</p>
<hr>
<h2 id="step-1-update-system-packages">Step 1: Update System Packages</h2>
<p><strong>Connect to your server via SSH:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ssh user@your-server-ip
</span></span></code></pre></div><p><strong>Update package lists and upgrade existing packages:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo apt update
</span></span><span style="display:flex;"><span>sudo apt upgrade -y
</span></span></code></pre></div><p><strong>Expected output:</strong></p>
<ul>
<li>Package lists are updated</li>
<li>System packages are upgraded</li>
<li>May require reboot if kernel is updated</li>
</ul>
<hr>
<h2 id="step-2-install-nginx">Step 2: Install NGINX</h2>
<p><strong>Install NGINX web server:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo apt install nginx -y
</span></span></code></pre></div><p><strong>Verify NGINX installation:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nginx -v
</span></span></code></pre></div><p><strong>Expected output:</strong></p>
<pre tabindex="0"><code>nginx version: nginx/1.18.0 (Ubuntu)
</code></pre><p><strong>Check NGINX status:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo systemctl status nginx
</span></span></code></pre></div><hr>
<h2 id="screenshot-nginx-status-check">Screenshot: NGINX Status Check</h2>
<p><strong>Terminal output showing NGINX is running:</strong></p>
<p><img src="screenshots/nginx-status.png" alt="NGINX Status"></p>
<p><strong>Key indicators:</strong></p>
<ul>
<li>✅ <code>Active: active (running)</code></li>
<li>✅ Green text indicating healthy status</li>
<li>✅ Process ID (PID) displayed</li>
<li>✅ Recent log entries visible</li>
</ul>
<hr>
<h2 id="step-3-install-php-and-extensions">Step 3: Install PHP and Extensions</h2>
<p><strong>Install PHP 8.1 and required extensions:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo apt install -y php8.1 php8.1-fpm php8.1-sqlite3 <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    php8.1-mbstring php8.1-xml php8.1-curl php8.1-zip
</span></span></code></pre></div><p><strong>Verify PHP installation:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>php -v
</span></span></code></pre></div><p><strong>Expected output:</strong></p>
<pre tabindex="0"><code>PHP 8.1.33 (cli) (built: Oct 24 2024 14:23:01) (NTS)
Copyright (c) The PHP Group
Zend Engine v4.1.33
</code></pre><hr>
<h2 id="step-4-install-composer">Step 4: Install Composer</h2>
<p><strong>Download and install Composer:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl -sS https://getcomposer.org/installer | sudo php -- <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    --install-dir<span style="color:#f92672">=</span>/usr/local/bin --filename<span style="color:#f92672">=</span>composer
</span></span></code></pre></div><p><strong>Verify Composer installation:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>composer --version
</span></span></code></pre></div><p><strong>Expected output:</strong></p>
<pre tabindex="0"><code>Composer version 2.8.3 2024-10-22 15:15:06
</code></pre><hr>
<h2 id="screenshot-php--composer-versions">Screenshot: PHP &amp; Composer Versions</h2>
<p><strong>Terminal output showing installed versions:</strong></p>
<p><img src="screenshots/php-composer-versions.png" alt="PHP and Composer Versions"></p>
<p><strong>Should display:</strong></p>
<ul>
<li>✅ PHP 8.1.x version</li>
<li>✅ Composer 2.x version</li>
<li>✅ No errors or warnings</li>
</ul>
<hr>
<h1 id="3-application-deployment">3. Application Deployment</h1>
<p>Deploying the PHP REST API</p>
<hr>
<h2 id="step-5-create-application-directory">Step 5: Create Application Directory</h2>
<p><strong>Create directory for the application:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo mkdir -p /var/www/php-todo-api
</span></span><span style="display:flex;"><span>cd /var/www/php-todo-api
</span></span></code></pre></div><p><strong>Set proper ownership:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo chown -R www-data:www-data /var/www/php-todo-api
</span></span></code></pre></div><p><strong>Note:</strong> <code>www-data</code> is the default NGINX/PHP-FPM user on Ubuntu/Debian</p>
<hr>
<h2 id="step-6-upload-application-files">Step 6: Upload Application Files</h2>
<p><strong>Option A: Using Git (recommended):</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cd /var/www/php-todo-api
</span></span><span style="display:flex;"><span>sudo -u www-data git clone https://github.com/yourusername/NKU-640.git .
</span></span><span style="display:flex;"><span>sudo -u www-data git sparse-checkout set homework4/php-version
</span></span><span style="display:flex;"><span>sudo -u www-data git checkout main
</span></span></code></pre></div><p><strong>Option B: Using SCP (from local machine):</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Run this on your LOCAL machine</span>
</span></span><span style="display:flex;"><span>scp -r homework4/php-version/* user@server-ip:/tmp/
</span></span><span style="display:flex;"><span>ssh user@server-ip
</span></span><span style="display:flex;"><span>sudo mv /tmp/* /var/www/php-todo-api/
</span></span><span style="display:flex;"><span>sudo chown -R www-data:www-data /var/www/php-todo-api
</span></span></code></pre></div><hr>
<h2 id="step-7-install-dependencies">Step 7: Install Dependencies</h2>
<p><strong>Navigate to application directory:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cd /var/www/php-todo-api
</span></span></code></pre></div><p><strong>Install Composer dependencies:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo -u www-data composer install --no-dev --optimize-autoloader
</span></span></code></pre></div><p><strong>Flags explained:</strong></p>
<ul>
<li><code>--no-dev</code>: Don&rsquo;t install development dependencies</li>
<li><code>--optimize-autoloader</code>: Create optimized class map for better performance</li>
<li><code>-u www-data</code>: Run as web server user</li>
</ul>
<hr>
<h2 id="screenshot-composer-install">Screenshot: Composer Install</h2>
<p><strong>Terminal showing dependency installation:</strong></p>
<p><img src="screenshots/composer-install.png" alt="Composer Install"></p>
<p><strong>Should show:</strong></p>
<ul>
<li>✅ Packages being downloaded</li>
<li>✅ Dependencies resolved</li>
<li>✅ Autoloader generated</li>
<li>✅ No errors</li>
</ul>
<hr>
<h2 id="step-8-configure-environment">Step 8: Configure Environment</h2>
<p><strong>Copy environment template:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo -u www-data cp .env.example .env
</span></span></code></pre></div><p><strong>Edit environment variables:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo nano .env
</span></span></code></pre></div><p><strong>Update for production:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># IMPORTANT: Set to false in production</span>
</span></span><span style="display:flex;"><span>DEBUG_MODE<span style="color:#f92672">=</span>false
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Use error level logging in production</span>
</span></span><span style="display:flex;"><span>LOG_LEVEL<span style="color:#f92672">=</span>error
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Database path</span>
</span></span><span style="display:flex;"><span>DATABASE_PATH<span style="color:#f92672">=</span>/var/www/php-todo-api/data/todo.db
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># CRITICAL: Change to a strong random secret</span>
</span></span><span style="display:flex;"><span>JWT_SECRET<span style="color:#f92672">=</span>change-this-to-a-strong-random-secret-key-at-least-32-chars
</span></span><span style="display:flex;"><span>JWT_EXPIRY<span style="color:#f92672">=</span><span style="color:#ae81ff">3600</span>
</span></span></code></pre></div><hr>
<h2 id="step-9-set-permissions">Step 9: Set Permissions</h2>
<p><strong>Create necessary directories:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo -u www-data mkdir -p /var/www/php-todo-api/data
</span></span><span style="display:flex;"><span>sudo -u www-data mkdir -p /var/www/php-todo-api/logs
</span></span></code></pre></div><p><strong>Set correct permissions:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Application files - read only</span>
</span></span><span style="display:flex;"><span>sudo find /var/www/php-todo-api -type f -exec chmod <span style="color:#ae81ff">644</span> <span style="color:#f92672">{}</span> <span style="color:#ae81ff">\;</span>
</span></span><span style="display:flex;"><span>sudo find /var/www/php-todo-api -type d -exec chmod <span style="color:#ae81ff">755</span> <span style="color:#f92672">{}</span> <span style="color:#ae81ff">\;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Data and logs - writable by web server</span>
</span></span><span style="display:flex;"><span>sudo chmod <span style="color:#ae81ff">775</span> /var/www/php-todo-api/data
</span></span><span style="display:flex;"><span>sudo chmod <span style="color:#ae81ff">775</span> /var/www/php-todo-api/logs
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Environment file - restricted</span>
</span></span><span style="display:flex;"><span>sudo chmod <span style="color:#ae81ff">600</span> /var/www/php-todo-api/.env
</span></span></code></pre></div><hr>
<h1 id="4-nginx-configuration">4. NGINX Configuration</h1>
<p>Configuring the Web Server</p>
<hr>
<h2 id="step-10-create-nginx-site-configuration">Step 10: Create NGINX Site Configuration</h2>
<p><strong>Create new site configuration file:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo nano /etc/nginx/sites-available/php-todo-api
</span></span></code></pre></div><p><strong>Add the following configuration:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-nginx" data-lang="nginx"><span style="display:flex;"><span><span style="color:#66d9ef">server</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">listen</span> <span style="color:#ae81ff">80</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">server_name</span> <span style="color:#e6db74">_</span>;  <span style="color:#75715e"># Replace with your domain or IP
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">root</span> <span style="color:#e6db74">/var/www/php-todo-api/public</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">index</span> <span style="color:#e6db74">index.php</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Logging
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#f92672">access_log</span> <span style="color:#e6db74">/var/log/nginx/todo-api-access.log</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">error_log</span> <span style="color:#e6db74">/var/log/nginx/todo-api-error.log</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">charset</span> <span style="color:#e6db74">utf-8</span>;
</span></span></code></pre></div><hr>
<h2 id="nginx-configuration-continued">NGINX Configuration (continued)</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-nginx" data-lang="nginx"><span style="display:flex;"><span>    <span style="color:#75715e"># Route all requests to index.php
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">location</span> <span style="color:#e6db74">/</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">try_files</span> $uri $uri/ <span style="color:#e6db74">/index.php?</span>$query_string;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># PHP-FPM configuration
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">location</span> ~ <span style="color:#e6db74">\.php$</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">fastcgi_pass</span> <span style="color:#e6db74">unix:/var/run/php/php-fpm.sock</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">fastcgi_index</span> <span style="color:#e6db74">index.php</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">fastcgi_param</span> <span style="color:#e6db74">SCRIPT_FILENAME</span> $document_root$fastcgi_script_name;
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">include</span> <span style="color:#e6db74">fastcgi_params</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Buffer settings
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#f92672">fastcgi_buffer_size</span> <span style="color:#ae81ff">128k</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">fastcgi_buffers</span> <span style="color:#ae81ff">256</span> <span style="color:#ae81ff">16k</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">fastcgi_busy_buffers_size</span> <span style="color:#ae81ff">256k</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">fastcgi_read_timeout</span> <span style="color:#ae81ff">240</span>;
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><hr>
<h2 id="nginx-configuration-continued-1">NGINX Configuration (continued)</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-nginx" data-lang="nginx"><span style="display:flex;"><span>    <span style="color:#75715e"># Deny access to hidden files
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">location</span> ~ <span style="color:#e6db74">/\.</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">deny</span> <span style="color:#e6db74">all</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">access_log</span> <span style="color:#66d9ef">off</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">log_not_found</span> <span style="color:#66d9ef">off</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Deny access to sensitive directories
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">location</span> ~ <span style="color:#e6db74">^/(vendor|tests|data|logs|\.env)</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">deny</span> <span style="color:#e6db74">all</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">return</span> <span style="color:#ae81ff">404</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">}</span>
</span></span></code></pre></div><p><strong>Save and exit:</strong> <code>Ctrl+X</code>, then <code>Y</code>, then <code>Enter</code></p>
<hr>
<h2 id="step-11-enable-the-site">Step 11: Enable the Site</h2>
<p><strong>Create symbolic link to enable the site:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo ln -s /etc/nginx/sites-available/php-todo-api <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    /etc/nginx/sites-enabled/php-todo-api
</span></span></code></pre></div><p><strong>Remove default site (optional):</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo rm /etc/nginx/sites-enabled/default
</span></span></code></pre></div><p><strong>Test NGINX configuration:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo nginx -t
</span></span></code></pre></div><p><strong>Expected output:</strong></p>
<pre tabindex="0"><code>nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
nginx: configuration file /etc/nginx/nginx.conf test is successful
</code></pre><hr>
<h2 id="screenshot-nginx-configuration-test">Screenshot: NGINX Configuration Test</h2>
<p><strong>Terminal showing successful configuration test:</strong></p>
<p><img src="screenshots/nginx-config-test.png" alt="NGINX Config Test"></p>
<p><strong>Should show:</strong></p>
<ul>
<li>✅ <code>syntax is ok</code></li>
<li>✅ <code>test is successful</code></li>
<li>✅ No error messages</li>
</ul>
<hr>
<h2 id="step-12-start-services">Step 12: Start Services</h2>
<p><strong>Reload NGINX to apply changes:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo systemctl reload nginx
</span></span></code></pre></div><p><strong>Ensure PHP-FPM is running:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo systemctl start php8.1-fpm
</span></span><span style="display:flex;"><span>sudo systemctl enable php8.1-fpm
</span></span></code></pre></div><p><strong>Verify both services are active:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo systemctl status nginx
</span></span><span style="display:flex;"><span>sudo systemctl status php8.1-fpm
</span></span></code></pre></div><hr>
<h2 id="screenshot-services-running">Screenshot: Services Running</h2>
<p><strong>Both NGINX and PHP-FPM active:</strong></p>
<p><img src="screenshots/services-status.png" alt="Services Status"></p>
<p><strong>Both should show:</strong></p>
<ul>
<li>✅ <code>Active: active (running)</code> in green</li>
<li>✅ Process IDs displayed</li>
<li>✅ No error messages in logs</li>
</ul>
<hr>
<h1 id="5-testing--verification">5. Testing &amp; Verification</h1>
<p>Verifying the Deployment Works</p>
<hr>
<h2 id="step-13-test-health-endpoint">Step 13: Test Health Endpoint</h2>
<p><strong>Test from the server itself:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl http://localhost/api/v1/health
</span></span></code></pre></div><p><strong>Expected response:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;status&#34;</span>: <span style="color:#e6db74">&#34;healthy&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;timestamp&#34;</span>: <span style="color:#e6db74">&#34;2025-11-07T20:00:00+00:00&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;service&#34;</span>: <span style="color:#e6db74">&#34;PHP TODO REST API&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;version&#34;</span>: <span style="color:#e6db74">&#34;v1&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;checks&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;database&#34;</span>: {<span style="color:#f92672">&#34;status&#34;</span>: <span style="color:#e6db74">&#34;healthy&#34;</span>},
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;php&#34;</span>: {<span style="color:#f92672">&#34;status&#34;</span>: <span style="color:#e6db74">&#34;healthy&#34;</span>, <span style="color:#f92672">&#34;version&#34;</span>: <span style="color:#e6db74">&#34;8.1.33&#34;</span>},
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;disk&#34;</span>: {<span style="color:#f92672">&#34;status&#34;</span>: <span style="color:#e6db74">&#34;healthy&#34;</span>},
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;memory&#34;</span>: {<span style="color:#f92672">&#34;status&#34;</span>: <span style="color:#e6db74">&#34;healthy&#34;</span>}
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><hr>
<h2 id="screenshot-health-check-response">Screenshot: Health Check Response</h2>
<p><strong>Terminal showing successful health check:</strong></p>
<p><img src="screenshots/health-check.png" alt="Health Check"></p>
<p><strong>Should display:</strong></p>
<ul>
<li>✅ Status: healthy</li>
<li>✅ Database connection working</li>
<li>✅ PHP version displayed</li>
<li>✅ All checks passing</li>
</ul>
<hr>
<h2 id="screenshot-browser-health-check">Screenshot: Browser Health Check</h2>
<p><strong>Browser displaying the health endpoint:</strong></p>
<p><img src="screenshots/browser-health-check.png" alt="Browser Health Check"></p>
<p><strong>Should show:</strong></p>
<ul>
<li>✅ JSON response properly formatted</li>
<li>✅ All status indicators showing &ldquo;healthy&rdquo;</li>
<li>✅ No 404 or 500 errors</li>
</ul>
<hr>
<h2 id="step-14-test-api-endpoints">Step 14: Test API Endpoints</h2>
<p><strong>Test signup endpoint:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl -X POST http://YOUR_SERVER_IP/api/v1/auth/signup <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  -H <span style="color:#e6db74">&#34;Content-Type: application/json&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  -d <span style="color:#e6db74">&#39;{
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;username&#34;: &#34;testuser&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;email&#34;: &#34;test@example.com&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;password&#34;: &#34;password123&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  }&#39;</span>
</span></span></code></pre></div><p><strong>Expected response:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;token&#34;</span>: <span style="color:#e6db74">&#34;eyJ0eXAiOiJKV1QiLCJhbGc...&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;user&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;id&#34;</span>: <span style="color:#e6db74">&#34;...&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;username&#34;</span>: <span style="color:#e6db74">&#34;testuser&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;email&#34;</span>: <span style="color:#e6db74">&#34;test@example.com&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;createdAt&#34;</span>: <span style="color:#e6db74">&#34;2025-11-07T20:00:00Z&#34;</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><hr>
<h2 id="screenshot-api-signup-test">Screenshot: API Signup Test</h2>
<p><strong>Terminal showing successful user signup:</strong></p>
<p><img src="screenshots/api-signup-test.png" alt="API Signup Test"></p>
<p><strong>Should display:</strong></p>
<ul>
<li>✅ JWT token returned</li>
<li>✅ User object with ID, username, email</li>
<li>✅ 201 Created status (if using -i flag)</li>
</ul>
<hr>
<h2 id="step-15-test-creating-a-list">Step 15: Test Creating a List</h2>
<p><strong>Create a TODO list:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl -X POST http://YOUR_SERVER_IP/api/v1/lists <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  -H <span style="color:#e6db74">&#34;Content-Type: application/json&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  -d <span style="color:#e6db74">&#39;{
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;name&#34;: &#34;Deployment Checklist&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;description&#34;: &#34;Tasks for NGINX deployment&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  }&#39;</span>
</span></span></code></pre></div><p><strong>Expected response:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;id&#34;</span>: <span style="color:#e6db74">&#34;550e8400-e29b-41d4-a716-446655440000&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;Deployment Checklist&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;description&#34;</span>: <span style="color:#e6db74">&#34;Tasks for NGINX deployment&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;createdAt&#34;</span>: <span style="color:#e6db74">&#34;2025-11-07T20:00:00Z&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;updatedAt&#34;</span>: <span style="color:#66d9ef">null</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><hr>
<h2 id="screenshot-create-list-test">Screenshot: Create List Test</h2>
<p><strong>Terminal showing successful list creation:</strong></p>
<p><img src="screenshots/create-list-test.png" alt="Create List Test"></p>
<p><strong>Should display:</strong></p>
<ul>
<li>✅ UUID generated for list</li>
<li>✅ List name and description returned</li>
<li>✅ Timestamps populated</li>
</ul>
<hr>
<h2 id="screenshot-database-verification">Screenshot: Database Verification</h2>
<p><strong>Terminal showing database contents:</strong></p>
<p><img src="screenshots/database-verification.png" alt="Database Verification"></p>
<p><strong>Should show:</strong></p>
<ul>
<li>✅ Database file exists</li>
<li>✅ Proper permissions (www-data owner)</li>
<li>✅ User count matches test data</li>
</ul>
<hr>
<h1 id="6-troubleshooting">6. Troubleshooting</h1>
<p>Common Issues and Solutions</p>
<hr>
<h2 id="common-issue-1-502-bad-gateway">Common Issue 1: 502 Bad Gateway</h2>
<p><strong>Symptom:</strong></p>
<ul>
<li>NGINX returns 502 error</li>
<li>&ldquo;Connection refused&rdquo; or &ldquo;upstream server&rdquo;</li>
</ul>
<p><strong>Causes &amp; Solutions:</strong></p>
<ol>
<li>
<p><strong>PHP-FPM not running:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo systemctl status php8.1-fpm
</span></span><span style="display:flex;"><span>sudo systemctl start php8.1-fpm
</span></span></code></pre></div></li>
<li>
<p><strong>Wrong socket path in NGINX config:</strong></p>
<ul>
<li>Check: <code>/var/run/php/php-fpm.sock</code> exists</li>
<li>Verify NGINX config has correct path</li>
</ul>
</li>
<li>
<p><strong>Permission issues:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo chmod <span style="color:#ae81ff">666</span> /var/run/php/php-fpm.sock
</span></span></code></pre></div></li>
</ol>
<hr>
<h2 id="common-issue-2-404-not-found">Common Issue 2: 404 Not Found</h2>
<p><strong>Symptom:</strong></p>
<ul>
<li>All endpoints return 404</li>
<li>NGINX serves but PHP not executed</li>
</ul>
<p><strong>Causes &amp; Solutions:</strong></p>
<ol>
<li>
<p><strong>Wrong document root:</strong></p>
<ul>
<li>Verify NGINX config: <code>root /var/www/php-todo-api/public;</code></li>
<li>Check that <code>public/index.php</code> exists</li>
</ul>
</li>
<li>
<p><strong>Rewrite rules not working:</strong></p>
<ul>
<li>Ensure <code>try_files $uri $uri/ /index.php?$query_string;</code> is present</li>
</ul>
</li>
<li>
<p><strong>Restart NGINX:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo systemctl restart nginx
</span></span></code></pre></div></li>
</ol>
<hr>
<h2 id="common-issue-3-database-errors">Common Issue 3: Database Errors</h2>
<p><strong>Symptom:</strong></p>
<ul>
<li>&ldquo;Unable to open database file&rdquo;</li>
<li>Database connection errors</li>
</ul>
<p><strong>Causes &amp; Solutions:</strong></p>
<ol>
<li>
<p><strong>Directory permissions:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo chown -R www-data:www-data /var/www/php-todo-api/data
</span></span><span style="display:flex;"><span>sudo chmod <span style="color:#ae81ff">775</span> /var/www/php-todo-api/data
</span></span></code></pre></div></li>
<li>
<p><strong>Wrong database path in .env:</strong></p>
<ul>
<li>Verify: <code>DATABASE_PATH=/var/www/php-todo-api/data/todo.db</code></li>
</ul>
</li>
<li>
<p><strong>Create directory if missing:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo -u www-data mkdir -p /var/www/php-todo-api/data
</span></span></code></pre></div></li>
</ol>
<hr>
<h2 id="common-issue-4-permission-denied">Common Issue 4: Permission Denied</h2>
<p><strong>Symptom:</strong></p>
<ul>
<li>&ldquo;Permission denied&rdquo; errors in logs</li>
<li>Cannot write to logs or database</li>
</ul>
<p><strong>Solution:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Fix ownership</span>
</span></span><span style="display:flex;"><span>sudo chown -R www-data:www-data /var/www/php-todo-api
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Fix permissions</span>
</span></span><span style="display:flex;"><span>sudo chmod <span style="color:#ae81ff">755</span> /var/www/php-todo-api
</span></span><span style="display:flex;"><span>sudo chmod <span style="color:#ae81ff">775</span> /var/www/php-todo-api/data
</span></span><span style="display:flex;"><span>sudo chmod <span style="color:#ae81ff">775</span> /var/www/php-todo-api/logs
</span></span><span style="display:flex;"><span>sudo chmod <span style="color:#ae81ff">600</span> /var/www/php-todo-api/.env
</span></span></code></pre></div><hr>
<h2 id="final-deployment-checklist">Final Deployment Checklist</h2>
<p><strong>Before going to production:</strong></p>
<p>✅ Set <code>DEBUG_MODE=false</code> in <code>.env</code>
✅ Use strong random <code>JWT_SECRET</code> (32+ chars)
✅ Set <code>LOG_LEVEL=error</code> for production
✅ Verify all services are enabled (auto-start on boot)
✅ Configure firewall (allow only 80/443)
✅ Install SSL certificate (HTTPS)
✅ Set up regular database backups
✅ Monitor disk space and memory
✅ Configure log rotation
✅ Test all API endpoints
✅ Document server IP and credentials</p>
<hr>
<h2 id="screenshot-final-working-deployment">Screenshot: Final Working Deployment</h2>
<p><strong>Complete working NGINX deployment:</strong></p>
<p><img src="screenshots/final-deployment.png" alt="Final Deployment"></p>
<p><strong>This screenshot shows:</strong></p>
<ul>
<li>✅ NGINX status: active and running</li>
<li>✅ PHP-FPM status: active and running</li>
<li>✅ Successful health check response</li>
<li>✅ API responding to requests</li>
</ul>
<hr>
<h2 id="summary">Summary</h2>
<p><strong>What we accomplished:</strong></p>
<ol>
<li>✅ Installed NGINX, PHP 8.1, and dependencies</li>
<li>✅ Deployed PHP REST API to <code>/var/www/php-todo-api</code></li>
<li>✅ Configured NGINX with FastCGI for PHP</li>
<li>✅ Set proper permissions and security</li>
<li>✅ Tested all endpoints successfully</li>
<li>✅ Verified database operations</li>
</ol>
<hr>
<h2 id="resources">Resources</h2>
<p><strong>Documentation:</strong></p>
<ul>
<li><a href="https://nginx.org/en/docs/">NGINX Documentation</a></li>
<li><a href="https://www.php.net/manual/en/install.fpm.php">PHP-FPM Configuration</a></li>
<li><a href="https://www.sqlite.org/docs.html">SQLite Documentation</a></li>
<li><a href="https://letsencrypt.org/">Let&rsquo;s Encrypt (SSL)</a></li>
</ul>
<p><strong>Monitoring Tools:</strong></p>
<ul>
<li><a href="https://htop.dev/">htop</a> - System monitoring</li>
<li><a href="https://www.netdata.cloud/">Netdata</a> - Real-time monitoring</li>
<li><a href="https://pm2.keymetrics.io/">PM2</a> - Process management</li>
</ul>
<p><strong>Security:</strong></p>
<ul>
<li><a href="https://help.ubuntu.com/community/UFW">UFW Firewall Guide</a></li>
<li><a href="https://owasp.org/">OWASP Security Guidelines</a></li>
</ul>

    </main>
    <footer>
        <p>&copy; 2025 NKU 640 Documentation</p>
    </footer>
</body>
</html>